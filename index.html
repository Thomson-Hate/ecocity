<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EcoCity Realistic Simulator</title>
<style>
body { margin:0; padding:0; font-family:sans-serif; background:#a0c4ff; }
#top-bar {
    display:flex; justify-content:space-around; padding:10px; background:rgba(255,255,255,0.3); backdrop-filter:blur(10px);
}
#map-container { position:relative; width:100%; height:600px; background: #90e0ef; overflow:hidden; border-top:2px solid #000; }
.building, .road {
    position:absolute; cursor:pointer; user-select:none;
}
.building { width:40px; height:40px; display:flex; align-items:center; justify-content:center; font-size:24px; border-radius:5px; }
.road { width:40px; height:40px; background:gray; }
#sidebar {
    position:absolute; top:10px; right:10px; width:250px; background:rgba(255,255,255,0.25); padding:10px; border-radius:10px; backdrop-filter:blur(5px);
}
button { width:100%; margin:5px 0; padding:8px; border:none; border-radius:5px; cursor:pointer; background:#48cae4; color:#000; font-weight:bold; }
button:hover { background:#00b4d8; }
#events { margin-top:10px; max-height:200px; overflow-y:auto; background:rgba(255,255,255,0.1); padding:5px; border-radius:5px; }
</style>
</head>
<body>

<div id="top-bar">
    <div>üí∞ –î–µ–Ω—å–≥–∏: <span id="money">0</span></div>
    <div>üè† –ù–∞—Å–µ–ª–µ–Ω–∏–µ: <span id="population">0</span></div>
    <div>üòä –°—á–∞—Å—Ç—å–µ: <span id="happiness">0</span>%</div>
    <div>‚ö° –≠–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏—è: <span id="electricity">0</span></div>
    <div>üíß –í–æ–¥–∞: <span id="water">0</span></div>
    <div>üçé –ï–¥–∞: <span id="food">0</span></div>
</div>

<div id="map-container"></div>

<div id="sidebar">
    <h3>–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç</h3>
    <button onclick="selectType('residential')">üè† –ñ–∏–ª–æ–π –¥–æ–º ($100)</button>
    <button onclick="selectType('industrial')">üè≠ –§–∞–±—Ä–∏–∫–∞ ($200)</button>
    <button onclick="selectType('power')">‚ö° –≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–Ω—Ü–∏—è ($150)</button>
    <button onclick="selectType('farm')">üåæ –§–µ—Ä–º–∞ ($120)</button>
    <button onclick="selectType('road')">üõ£Ô∏è –î–æ—Ä–æ–≥–∞</button>
    <div id="events"></div>
</div>

<script>
// =================== –ì–æ—Ä–æ–¥ ===================
const city = {
    money:5000,
    population:50,
    happiness:100,
    resources:{electricity:50,water:50,food:50},
    buildings:[], // {type, x, y, element}
    roads:[],
};

let selectedType = null;

// =================== –û–±—ä–µ–∫—Ç—ã ===================
const buildingInfo = {
    residential:{icon:'üè†',cost:100,upkeep:{money:0,electricity:1,water:1},production:{population:5}},
    industrial:{icon:'üè≠',cost:200,upkeep:{money:2,electricity:5,water:2},production:{money:10}},
    power:{icon:'‚ö°',cost:150,upkeep:{money:1},production:{electricity:20}},
    farm:{icon:'üåæ',cost:120,upkeep:{money:1,water:2},production:{food:20}},
    road:{icon:'üõ£Ô∏è',cost:20,upkeep:{},production:{}}
};

// =================== UI ===================
const map = document.getElementById('map-container');
const eventsDiv = document.getElementById('events');

function selectType(type){ selectedType=type; logEvent(`–í—ã–±—Ä–∞–Ω–æ: ${type}`); }

function logEvent(text){
    const div = document.createElement('div'); div.innerText=text; eventsDiv.prepend(div);
}

function updateUI(){
    document.getElementById('money').innerText=city.money;
    document.getElementById('population').innerText=city.population;
    document.getElementById('happiness').innerText=city.happiness;
    document.getElementById('electricity').innerText=city.resources.electricity;
    document.getElementById('water').innerText=city.resources.water;
    document.getElementById('food').innerText=city.resources.food;
}

// =================== –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ ===================
map.addEventListener('click', e=>{
    if(!selectedType) { logEvent("–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç!"); return; }
    const rect = map.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    placeObject(selectedType,x-20,y-20);
});

function placeObject(type,x,y){
    const info = buildingInfo[type];
    if(city.money < info.cost) { logEvent("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!"); return; }
    city.money -= info.cost;

    const elem = document.createElement('div');
    elem.className = type==='road'?'road':'building';
    elem.style.left=x+'px';
    elem.style.top=y+'px';
    elem.innerText=info.icon;
    map.appendChild(elem);

    if(type==='road'){ city.roads.push({x,y,element:elem}); }
    else{ city.buildings.push({type,x,y,element:elem}); }

    logEvent(`–ü–æ—Å—Ç–∞–≤–ª–µ–Ω–æ: ${type} (${Math.round(x)},${Math.round(y)})`);
    updateUI();
}

// =================== –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª ===================
setInterval(()=>{
    // —Ä–µ—Å—É—Ä—Å—ã –∏ –¥–æ—Ö–æ–¥
    let moneyChange=0;
    let population=50;
    let electricity=50;
    let water=50;
    let food=50;

    city.buildings.forEach(b=>{
        const info = buildingInfo[b.type];
        // —Ä–∞—Å—Ö–æ–¥—ã
        moneyChange -= info.upkeep.money||0;
        electricity -= info.upkeep.electricity||0;
        water -= info.upkeep.water||0;
        food -= info.upkeep.food||0;
        // –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
        moneyChange += info.production.money||0;
        electricity += info.production.electricity||0;
        water += info.production.water||0;
        food += info.production.food||0;
        population += info.production.population||0;
    });

    city.money += moneyChange;
    city.population = population;
    city.resources.electricity = electricity;
    city.resources.water = water;
    city.resources.food = food;

    let penalty=0;
    if(electricity<0) penalty+=10;
    if(water<0) penalty+=10;
    if(food<population) penalty+=10;
    city.happiness = Math.max(0,100-penalty);

    updateUI();

    if(Math.random()<0.01){ city.money=Math.max(0,city.money-100); logEvent("–ü—Ä–æ–∏–∑–æ—à–ª–æ —Å–æ–±—ã—Ç–∏–µ: —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫—Ä–∏–∑–∏—Å!"); }

},2000);

updateUI();
</script>

</body>
</html>
